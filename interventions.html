<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Interventions</title>
  <link href="https://fonts.googleapis.com/css2?family=Alata&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />

  <style>
    /* Timeline spécifique */
    #titre-interventions {
      text-align: center;
    }

    #timeline-wrapper {
      position: relative;
      margin-top: 2rem;
    }

    /* Zone outils sous le titre */
    #tools-box {
      position: relative;
      width: 260px;
      background: #ffffff;
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      margin: 1rem auto 2rem auto;
    }

    .tools-group {
      margin-bottom: .75rem;
    }
    .tools-label {
      display: block;
      font-size: .9rem;
      margin-bottom: .25rem;
      color: #222;
    }
    #search-keyword, #date-start, #date-end {
      width: 100%;
      padding: .45rem .55rem;
      border: 1px solid #ddd;
      border-radius: 8px;
      background: #fff;
      font-family: 'Alata', sans-serif;
      letter-spacing: .02em;
    }
    #btn-reset {
      width: 100%;
      padding: .5rem .75rem;
      border: none;
      border-radius: 8px;
      background: #1f1f1f;
      color: #fff;
      letter-spacing: .02em;
      cursor: pointer;
      transition: transform .2s ease, background .1s ease;
    }
    #btn-reset:hover { transform: scale(.98); }
    #btn-reset:active { background: #444; transform: scale(.96); }

    /* Timeline grid */
    .timeline-grid {
      display: grid;
      grid-template-columns: 1fr 2px 1fr;
      column-gap: 2rem;
      row-gap: 2rem;
      position: relative;
    }

    #timeline-line {
      position: absolute;
      top: 0;
      bottom: 0;
      left: 50%;
      width: 2px;
      transform: translateX(-50%);
      background: #1f1f1f;
    }

    .timeline-event {
      display: contents;
    }

    .timeline-dot {
      grid-column: 2;
      position: relative;
      height: 0;
    }
    .timeline-dot::after {
      content: "";
      position: absolute;
      left: 50%;
      top: .5rem;
      transform: translate(-50%, -50%);
      width: 10px;
      height: 10px;
      background: #1f1f1f;
      border-radius: 50%;
    }

    .event-left {
      grid-column: 1;
      display: flex;
      justify-content: flex-end;
    }
    .event-card {
      width: 380px;
      max-width: 100%;
      background: #ffffff;
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 1rem 1.25rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      text-align: center;
    }
    .event-date {
      font-weight: 700;
      margin: 0 0 .35rem 0;
      color: #222;
    }
    .event-lieu {
      margin: 0;
      color: #222;
      opacity: .9;
    }

    .event-right {
      grid-column: 3;
      align-self: start;
    }
    .event-type {
      font-size: 1.25rem;
      margin: 0 0 .35rem 0;
      color: #222;
      letter-spacing: .015em;
    }
    .event-description {
      margin: 0 0 .35rem 0;
      color: #222;
      letter-spacing: .015em;
      line-height: 1.6;
    }
    .event-link a {
      text-decoration: none;
      color: #0077cc;
      font-weight: 700;
      transition: color .2s ease;
    }
    .event-link a:hover { color: #005999; }

    #timeline-end-dot {
      position: absolute;
      left: 50%;
      bottom: -8px;
      transform: translateX(-50%);
      width: 10px;
      height: 10px;
      background: #1f1f1f;
      border-radius: 50%;
    }

    @media (max-width: 880px) {
      #tools-box { width: min(92vw, 420px); }
      .timeline-grid { grid-template-columns: 1fr; }
      #timeline-line { left: 16px; transform: none; }
      .timeline-dot { grid-column: 1; }
      .timeline-dot::after { left: 16px; transform: translate(-50%, -50%); }
      .event-left { grid-column: 1; justify-content: flex-start; }
      .event-right { grid-column: 1; margin-top: .5rem; }
      .event-card { width: 100%; }
      #timeline-end-dot { left: 16px; transform: translateX(-50%); }
    }
  </style>
</head>
<body style="outline: none;">

  <div id="header-placeholder"></div>

  <div class="container">
    <h1 id="titre-interventions">Interventions & Colloques</h1>
    <p id="texte-intro-interventions" class="publications-text">
      Présentation chronologique des interventions, colloques et communications du professeur. Filtrez par période ou par mots-clés.
    </p>

    <!-- Zone outils sous le titre -->
    <aside id="tools-box" aria-label="Outils de filtrage">
      <h2 id="tools-title">Filtrer</h2>
      <div class="tools-group">
        <label for="search-keyword" class="tools-label" id="label-mots-cles">Mots-clés</label>
        <input type="text" id="search-keyword" placeholder="ex. colloque, Paris, éducation…" />
      </div>
      <div class="tools-group">
        <span class="tools-label" id="label-periode">Période</span>
        <input type="date" id="date-start" aria-label="Date de début" />
        <div style="height:.5rem;"></div>
        <input type="date" id="date-end" aria-label="Date de fin" />
      </div>
      <button id="btn-reset" type="button">Réinitialiser</button>
    </aside>

    <section id="timeline-wrapper" aria-label="Chronologie des interventions">
      <div id="timeline-line" aria-hidden="true"></div>
      <div class="timeline-grid" id="timeline-grid">

        <!-- 10 événements identiques au précédent code, laissés inchangés -->
        <!-- Copie les 10 div.timeline-event de mon code précédent ici -->

      </div>
      <div id="timeline-end-dot" aria-hidden="true"></div>
    </section>
  </div>

  <div id="footer-placeholder"></div>

  <script>
    function loadHTML(id, url) {
      fetch(url)
        .then(r => { if (!r.ok) throw new Error('Erreur de chargement'); return r.text(); })
        .then(html => { document.getElementById(id).innerHTML = html; })
        .catch(err => console.error('Erreur:', err));
    }
    loadHTML('header-placeholder', 'header.html');
    loadHTML('footer-placeholder', 'footer.html');
  </script>

  <script>
    // Filtrage : mots-clés + dates
    const $search = document.getElementById('search-keyword');
    const $start  = document.getElementById('date-start');
    const $end    = document.getElementById('date-end');
    const $reset  = document.getElementById('btn-reset');
    const $events = Array.from(document.querySelectorAll('.timeline-event'));

    function normalize(str){ return (str || '').toLowerCase().normalize('NFD').replace(/\p{Diacritic}/gu,''); }

    function applyFilters() {
      const kw = normalize($search.value);
      const hasKw = kw.length > 0;

      const start = $start.value ? new Date($start.value) : null;
      const end   = $end.value   ? new Date($end.value)   : null;

      $events.forEach(ev => {
        const evDate = new Date(ev.getAttribute('data-date'));
        let visible = true;
        if (start && evDate < start) visible = false;
        if (end && evDate > end)     visible = false;
        if (hasKw) {
          const bag = normalize(
            (ev.getAttribute('data-keywords') || '') + ' ' +
            ev.querySelector('.event-description').textContent
          );
          if (!bag.includes(kw)) visible = false;
        }
        ev.style.display = visible ? 'contents' : 'none';
      });
    }

    $search.addEventListener('input', applyFilters);
    $start.addEventListener('change', applyFilters);
    $end.addEventListener('change', applyFilters);
    $reset.addEventListener('click', ()=>{
      $search.value=''; $start.value=''; $end.value='';
      applyFilters();
    });
  </script>
</body>
</html>
